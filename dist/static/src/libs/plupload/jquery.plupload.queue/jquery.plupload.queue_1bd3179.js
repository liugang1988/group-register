!function(a,o){function _(a){return plupload.translate(a)||a}function c(c,v){v.contents().each(function(i,_){_=a(_),_.is(".plupload")||_.remove()}),v.prepend('<div class="plupload_wrapper plupload_scroll"><div id="'+c+'_container" class="plupload_container"><div class="plupload"><div class="plupload_header"><div class="plupload_header_content"><div class="plupload_header_title">'+_("Select files")+'</div><div class="plupload_header_text">'+_("Add files to the upload queue and click the start button.")+'</div></div></div><div class="plupload_content"><div class="plupload_filelist_header"><div class="plupload_file_name">'+_("Filename")+'</div><div class="plupload_file_action">&nbsp;</div><div class="plupload_file_status"><span>'+_("Status")+'</span></div><div class="plupload_file_size">'+_("Size")+'</div><div class="plupload_clearer">&nbsp;</div></div><ul id="'+c+'_filelist" class="plupload_filelist"></ul><div class="plupload_filelist_footer"><div class="plupload_file_name"><div class="plupload_buttons"><a href="#" class="plupload_button plupload_add" id="'+c+'_browse">'+_("Add Files")+'</a><a href="#" class="plupload_button plupload_start">'+_("Start Upload")+'</a></div><span class="plupload_upload_status"></span></div><div class="plupload_file_action"></div><div class="plupload_file_status"><span class="plupload_total_status">0%</span></div><div class="plupload_file_size"><span class="plupload_total_file_size">0 b</span></div><div class="plupload_progress"><div class="plupload_progress_container"><div class="plupload_progress_bar"></div></div></div><div class="plupload_clearer">&nbsp;</div></div></div></div></div><input type="hidden" id="'+c+'_count" name="'+c+'_count" value="0" /></div>')}var v={};a.fn.pluploadQueue=function(h){return h?(this.each(function(){function b(_){var c;_.status==plupload.DONE&&(c="plupload_done"),_.status==plupload.FAILED&&(c="plupload_failed"),_.status==plupload.QUEUED&&(c="plupload_delete"),_.status==plupload.UPLOADING&&(c="plupload_uploading");var v=a("#"+_.id).attr("class",c).find("a").css("display","block");_.hint&&v.attr("title",_.hint)}function g(){a("span.plupload_total_status",F).html(D.total.percent+"%"),a("div.plupload_progress_bar",F).css("width",D.total.percent+"%"),a("span.plupload_upload_status",F).html(o.sprintf(_("Uploaded %d/%d files"),D.total.uploaded,D.files.length))}function E(){var c,v=a("ul.plupload_filelist",F).html(""),h=0;a.each(D.files,function(i,_){c="",_.status==plupload.DONE&&(_.target_name&&(c+='<input type="hidden" name="'+z+"_"+h+'_tmpname" value="'+plupload.xmlEncode(_.target_name)+'" />'),c+='<input type="hidden" name="'+z+"_"+h+'_name" value="'+plupload.xmlEncode(_.name)+'" />',c+='<input type="hidden" name="'+z+"_"+h+'_status" value="'+(_.status==plupload.DONE?"done":"failed")+'" />',h++,a("#"+z+"_count").val(h)),v.append('<li id="'+_.id+'"><div class="plupload_file_name"><span>'+_.name+'</span></div><div class="plupload_file_action"><a href="#"></a></div><div class="plupload_file_status">'+_.percent+'%</div><div class="plupload_file_size">'+plupload.formatSize(_.size)+'</div><div class="plupload_clearer">&nbsp;</div>'+c+"</li>"),b(_),a("#"+_.id+".plupload_delete a").click(function(e){a("#"+_.id).remove(),D.removeFile(_),e.preventDefault()})}),a("span.plupload_total_file_size",F).html(plupload.formatSize(D.total.size)),a("span.plupload_add_text",F).html(0===D.total.queued?_("Add Files"):o.sprintf(_("%d files queued"),D.total.queued)),a("a.plupload_start",F).toggleClass("plupload_disabled",D.files.length==D.total.uploaded+D.total.failed),v[0].scrollTop=v[0].scrollHeight,g(),!D.files.length&&D.features.dragdrop&&D.settings.dragdrop&&a("#"+z+"_filelist").append('<li class="plupload_droptext">'+_("Drag files here.")+"</li>")}function y(){delete v[z],D.destroy(),F.html(k),D=F=k=null}var D,F,z,k;F=a(this),z=F.attr("id"),z||(z=plupload.guid(),F.attr("id",z)),k=F.html(),c(z,F),h=a.extend({dragdrop:!0,browse_button:z+"_browse",container:z},h),h.dragdrop&&(h.drop_element=z+"_filelist"),D=new plupload.Uploader(h),v[z]=D,D.bind("UploadFile",function(_,c){a("#"+c.id).addClass("plupload_current_file")}),D.bind("Init",function(_,c){!h.unique_names&&h.rename&&F.on("click","#"+z+"_filelist div.plupload_file_name span",function(e){var c,v,h,b=a(e.target),g="";c=_.getFile(b.parents("li")[0].id),h=c.name,v=/^(.+)(\.[^.]+)$/.exec(h),v&&(h=v[1],g=v[2]),b.hide().after('<input type="text" />'),b.next().val(h).focus().blur(function(){b.show().next().remove()}).keydown(function(e){var _=a(this);13==e.keyCode&&(e.preventDefault(),c.name=_.val()+g,b.html(c.name),_.blur())})}),a("#"+z+"_container").attr("title","Using runtime: "+c.runtime),a("a.plupload_start",F).click(function(e){a(this).hasClass("plupload_disabled")||D.start(),e.preventDefault()}),a("a.plupload_stop",F).click(function(e){e.preventDefault(),D.stop()}),a("a.plupload_start",F).addClass("plupload_disabled")}),D.bind("Error",function(c,v){var h,b=v.file;b&&(h=v.message,v.details&&(h+=" ("+v.details+")"),v.code==plupload.FILE_SIZE_ERROR&&alert(_("Error: File too large:")+" "+b.name),v.code==plupload.FILE_EXTENSION_ERROR&&alert(_("Error: Invalid file extension:")+" "+b.name),b.hint=h,a("#"+b.id).attr("class","plupload_failed").find("a").css("display","block").attr("title",h)),v.code===plupload.INIT_ERROR&&setTimeout(function(){y()},1)}),D.bind("PostInit",function(c){c.settings.dragdrop&&c.features.dragdrop&&a("#"+z+"_filelist").append('<li class="plupload_droptext">'+_("Drag files here.")+"</li>")}),D.init(),D.bind("StateChanged",function(){D.state===plupload.STARTED?(a("li.plupload_delete a,div.plupload_buttons",F).hide(),D.disableBrowse(!0),a("span.plupload_upload_status,div.plupload_progress,a.plupload_stop",F).css("display","block"),a("span.plupload_upload_status",F).html("Uploaded "+D.total.uploaded+"/"+D.files.length+" files"),h.multiple_queues&&a("span.plupload_total_status,span.plupload_total_file_size",F).show()):(E(),a("a.plupload_stop,div.plupload_progress",F).hide(),a("a.plupload_delete",F).css("display","block"),h.multiple_queues&&D.total.uploaded+D.total.failed==D.files.length&&(a(".plupload_buttons,.plupload_upload_status",F).css("display","inline"),D.disableBrowse(!1),a(".plupload_start",F).addClass("plupload_disabled"),a("span.plupload_total_status,span.plupload_total_file_size",F).hide()))}),D.bind("FilesAdded",E),D.bind("FilesRemoved",function(){var _=a("#"+z+"_filelist").scrollTop();E(),a("#"+z+"_filelist").scrollTop(_)}),D.bind("FileUploaded",function(a,_){b(_)}),D.bind("UploadProgress",function(_,c){a("#"+c.id+" div.plupload_file_status",F).html(c.percent+"%"),b(c),g()}),h.setup&&h.setup(D)}),this):v[a(this[0]).attr("id")]}}(jQuery,mOxie);