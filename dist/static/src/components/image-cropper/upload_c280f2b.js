define("src/components/image-cropper/upload",function(require,exports,module){"use strict";function a(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(exports,"__esModule",{value:!0});var c=require("src/utils/http"),h=a(c),v="https:"===location.protocol?"https://up.qbox.me":"http://upload.qiniu.com",g=function(a){if(null===a||"undefined"==typeof a)return"";var c=a+"",h="",v=void 0,g=void 0,y=0;v=g=0,y=c.length;for(var n=0;y>n;n++){var C=c.charCodeAt(n),k=null;if(128>C)g++;else if(C>127&&2048>C)k=String.fromCharCode(C>>6|192,63&C|128);else if(63488&C^!0)k=String.fromCharCode(C>>12|224,C>>6&63|128,63&C|128);else{if(64512&C^!0)throw new RangeError("Unmatched trail surrogate at "+n);var A=c.charCodeAt(++n);if(64512&A^!0)throw new RangeError("Unmatched lead surrogate at "+(n-1));C=((1023&C)<<10)+(1023&A)+65536,k=String.fromCharCode(C>>18|240,C>>12&63|128,C>>6&63|128,63&C|128)}null!==k&&(g>v&&(h+=c.slice(v,g)),h+=k,v=g=n+1)}return g>v&&(h+=c.slice(v,y)),h},y=function(a){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=void 0,v=void 0,y=void 0,C=void 0,k=void 0,A=void 0,U=void 0,b=void 0,i=0,w=0,S="",R=[];if(!a)return a;a=g(a+"");do h=a.charCodeAt(i++),v=a.charCodeAt(i++),y=a.charCodeAt(i++),b=h<<16|v<<8|y,C=b>>18&63,k=b>>12&63,A=b>>6&63,U=63&b,R[w++]=c.charAt(C)+c.charAt(k)+c.charAt(A)+c.charAt(U);while(i<a.length);S=R.join("");var T=a.length%3;return 1===T?S=S.slice(0,-2)+"==":2===T&&(S=S.slice(0,-1)+"="),S},C=function(a){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],h=c.key,v=c.token,g=c.accessUrl,C=c.actionUrl,k=c.success,A=c.progress,U=c.fail;C=C+"/putb64/-1/key/"+y(h);var b=new XMLHttpRequest;b.open("POST",C,!0),b.setRequestHeader("Content-Type","application/octet-stream"),b.setRequestHeader("Authorization","UpToken "+v),b.addEventListener("progress",function(a){a.lengthComputable&&"function"==typeof A&&A(Math.round(a.loaded/a.total*100))},!1),b.onreadystatechange=function(){if(4===b.readyState){var a=b.responseText;if(a=JSON.parse(a),b.status>=200&&b.status<300||304===b.status){var c=a.key;k(g+"/"+c,c)}else U(a)}},b.send(a.replace(/^data:image\/.*;base64,/,""))};exports["default"]=function(a){var c=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],g=c.success,y=c.progress,k=c.fail;h["default"].get("/api/cbs/v3/upload/token").then(function(c){var d=c.data&&c.data[0];d?C(a,{key:d.key,token:d.uploadToken,accessUrl:d.accessUrl,actionUrl:v,success:g,progress:y,fail:k}):"function"==typeof k&&k()})["catch"](function(a){"function"==typeof k&&k(a)})},module.exports=exports["default"]});