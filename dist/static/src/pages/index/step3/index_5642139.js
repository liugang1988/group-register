define("src/pages/index/step3/index",function(require,exports){"use strict";function a(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(exports,"__esModule",{value:!0});var c=require("src/utils/validatorMixin"),g=a(c),h=require("src/utils/qiniuUpload"),v=a(h),y=require("src/utils/validators");exports.default={mixins:[g.default],template:'<div class="m-box"><ui-form type="v"><ui-form-item label="入驻网店数：" :tips="getErrorText($v.chainCount, msg.chainCount)" :state="$v.chainCount.$error" :required="true"><input class="u-input-text w50" type="text" placeholder="请输入整数" v-model="chainCount" @blur="$v.chainCount.$touch()" @focus="$v.chainCount.$reset()"></ui-form-item><ui-form-item label="公司名称：" :tips="getErrorText($v.organName, msg.organName)" :state="$v.organName.$error" :required="true"><input class="u-input-text w50" type="text" placeholder="例如：深圳市指尖城市网络科技有限公司" v-model="organName" @blur="$v.organName.$touch()" @focus="$v.organName.$reset()"><div class="m-form-item__text"><span class="f-c-red">{{organName.length || 0}}/30</span>字</div></ui-form-item><ui-form-item label="法定代表人：" :tips="getErrorText($v.legalPerson, msg.legalPerson)" :state="$v.legalPerson.$error" :required="true"><input class="u-input-text w50" type="text" placeholder="法定代表人" v-model="legalPerson" @blur="$v.legalPerson.$touch()" @focus="$v.legalPerson.$reset()"><div class="m-form-item__text"><span class="f-c-red">{{legalPerson.length || 0}}/15</span>字</div></ui-form-item><ui-form-item label="法人联系电话：" :tips="getErrorText($v.legalPhone, msg.legalPhone)" :state="$v.legalPhone.$error" :required="true"><input class="u-input-text w50" type="text" placeholder="法人联系电话" v-model="legalPhone" @blur="$v.legalPhone.$touch()" @focus="$v.legalPhone.$reset()"></ui-form-item><ui-form-item label="法人身份证号码：" :tips="getErrorText($v.identityCard, msg.identityCard)" :state="$v.identityCard.$error" :required="true"><input class="u-input-text w50" type="text" placeholder="法人身份证号码" v-model="identityCard" @blur="$v.identityCard.$touch()" @focus="$v.identityCard.$reset()"></ui-form-item><ui-form-item label="上传认证资料：" :tips="getErrorText($v.pics, msg.pics)" :state="$v.pics.$error" :required="true"><div class="certificate-list"><ui-form-upload-img v-for="(item,index) of pics" :id="index" :title="item.title" :url="item.url" :percent="item.percent" :status="item.status" :init-fn="initFn" @remove="removeImg"></ui-form-upload-img></div></ui-form-item><ui-form-item><ui-button type="primary" @click.native="submit">提交</ui-button></ui-form-item></ui-form></div>',props:{errorStep:{"default":!1},currentStep:{"default":2}},data:function(){return{chainCount:"",organName:"",legalPerson:"",legalPhone:"",identityCard:"",isShowImageCropper:!1,picIndex:"",pics:[{id:"",key:"",title:"营业执照副本",url:"",status:0,percent:0},{id:"",key:"",title:"法人身份证正面",url:"",status:0,percent:0},{id:"",key:"",title:"法人身份证反面",url:"",status:0,percent:0},{id:"",key:"",title:"负责人身份证正面",url:"",status:0,percent:0},{id:"",key:"",title:"负责人身份证反面",url:"",status:0,percent:0},{id:"",key:"",title:"负责人手持身份证",url:"",status:0,percent:0}],msg:{chainCount:[{type:"required",text:"请填写网店数量！"},{type:"isNNInt",text:"请填写数字！"}],organName:[{type:"required",text:"请填写公司名称！"},{type:"maxLength",text:"公司名称最多不超过30个字！"},{type:"noSpace",text:"公司名称不能出现空格！"}],legalPerson:[{type:"required",text:"请填写法定代表人！"},{type:"maxLength",text:"法定代表人最多不超过15个字！"},{type:"noSpace",text:"法定代表人不能出现空格！"}],legalPhone:[{type:"required",text:"请填写法定代表人联系电话！"},{type:"tel",text:"法定代表人联系电话填写错误！"}],identityCard:[{type:"required",text:"请填写法定代表人身份证！"},{type:"isIdCard",text:"法定代表人身份证填写错误！"},{type:"maxLength",text:"法定代表人身份证最多18位！"}],pics:[{type:"$each",text:"认证资料必须全部上传或者还有正在上传中的资料！"}]},errorText:""}},validations:{chainCount:{required:y.required,isNNInt:y.isNNInt},organName:{required:y.required,maxLength:y.maxLength(30),noSpace:y.noSpace},legalPerson:{required:y.required,maxLength:y.maxLength(15),noSpace:y.noSpace},legalPhone:{required:y.required,tel:function(a){return y.isLandlines(a)||y.isMobile(a)}},identityCard:{required:y.required,isIdCard:y.isIdCard,maxLength:y.maxLength(18)},pics:{required:y.required,$each:{url:{required:y.required}}},all:["chainCount","organName","legalPerson","legalPhone","identityCard","pics"]},methods:{initFn:function(a,c){var g=this;v.default(a,{UploadFile:function(a){var h=g.pics[c];h.id=a,h.status=1,h.percent=0,h.loaded=0,h.url="",h.key=""},onProgress:function(a,c){g.pics.some(function(g){return g.id===a?(g.percent=c.percent,!0):!1})},onUploaded:function(a,c,h){g.pics.some(function(g){return g.id===a?(g.key=c,g.url=h,g.status=2,!0):!1})},onError:function(a,c){a?g.pics.some(function(h,v){return h.id===a?(g.toast({content:"第"+(v+1)+"个文件："+c,type:"warn"}),g.pics.splice(v,1),!0):!1}):g.toast({content:c,type:"warn"})}})},removeImg:function(a){this.pics.splice(a,1)},submit:function(){var a=this;this.$v.all.$touch(),this.$v.all.$error||this.isSubmit||(this.isSubmit=!0,this.$http.post("/api/group/v3/auto/organ/submit",{chainCount:this.chainCount,organName:this.organName,legalPerson:this.legalPerson,legalPhone:this.legalPhone,identityCard:this.identityCard,bizLicense:this.pics[0].key,legalCardFront:this.pics[1].key,legalCardRev:this.pics[2].key,contactCardFront:this.pics[3].key,contactCardRev:this.pics[4].key,contactCardHand:this.pics[5].key}).then(function(){a.isSubmit=!1,a.$emit("next")},function(c){a.toast({content:c.statusText,type:"warn"}),a.isSubmit=!1}))},getInfor:function(){var a=this;this.$http.get("/api/group/v3/auto/organ/info").then(function(c){var g=c.data;a.chainCount=g.chainCount,a.organName=g.organName,a.legalPerson=g.legalPerson,a.legalPhone=g.legalPhone,a.identityCard=g.identityCard,g.bizLicense&&(a.pics[0].status=2,a.pics[0].key=g.bizLicense,a.pics[0].url=g.bizLicenseUrl),g.legalCardFront&&(a.pics[1].status=2,a.pics[1].key=g.legalCardFront,a.pics[1].url=g.legalCardFrontUrl),g.legalCardRev&&(a.pics[2].status=2,a.pics[2].key=g.legalCardRev,a.pics[2].url=g.legalCardRevUrl),g.contactCardFront&&(a.pics[3].status=2,a.pics[3].key=g.contactCardFront,a.pics[3].url=g.contactCardFrontUrl),g.contactCardRev&&(a.pics[4].status=2,a.pics[4].key=g.contactCardRev,a.pics[4].url=g.contactCardRevUrl),g.contactCardHand&&(a.pics[5].status=2,a.pics[5].key=g.contactCardHand,a.pics[5].url=g.contactCardHandUrl)},function(c){a.toast({content:c.statusText,type:"warn"})})}},created:function(){this.errorStep&&this.getInfor()}}});